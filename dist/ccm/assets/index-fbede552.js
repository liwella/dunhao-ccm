import{_ as G}from"./CommonPage-adc377bd.js";import{e as H,o as q,j as B,ag as J,w as i,n as I,ah as D,k as l,m as k,l as t,D as P,x as W,_ as c,ai as X,aj as _,q as b,ae as Y,z as Z,h as f,ak as ee}from"./index-b4715686.js";import{_ as te}from"./CrudTable-951627ac.js";import{_ as oe}from"./QueryBarItem-6d0a29f9.js";import{_ as le}from"./TheIcon-675d416b.js";import{f as U}from"./common-f40b2249.js";import{r as $}from"./icon-ddab9740.js";import{u as ae,_ as ne,a as ie}from"./useCRUD-203db45b.js";import{_ as se}from"./Switch-3b94eb8e.js";import{_ as re}from"./Input-b17a8cba.js";import"./AppPage-822d7352.js";import"./_plugin-vue_export-helper-c27b6911.js";import"./use-merged-state-00f380d9.js";import"./Space-0006ea51.js";import"./Checkbox-b66d0992.js";import"./Popover-20977188.js";import"./get-eca5ae1b.js";import"./use-compitable-42d436f5.js";import"./Suffix-82f6409d.js";import"./Dropdown-2c8aa49c.js";import"./create-d1a5db2f.js";import"./Tooltip-dafec684.js";import"./Empty-7a6e38d2.js";import"./use-locale-16835a4e.js";import"./Select-880742f7.js";import"./Tag-be9a6970.js";import"./Eye-35241382.js";const de={flex:"","justify-end":""},ue={__name:"CrudModal",props:{width:{type:String,default:"600px"},title:{type:String,default:""},showFooter:{type:Boolean,default:!0},visible:{type:Boolean,required:!0},loading:{type:Boolean,default:!1}},emits:["onSave","modalInvisible"],setup(o,{emit:r}){const x=o,s=H({get(){return x.visible},set(p){r("modalInvisible",p)}});return(p,d)=>{const y=c,w=X;return q(),B(w,{show:t(s),"onUpdate:show":d[2]||(d[2]=u=>P(s)?s.value=u:null),style:W({width:o.width}),preset:"card",title:o.title,size:"huge",bordered:!1},J({default:i(()=>[D(p.$slots,"default")]),_:2},[o.showFooter?{name:"footer",fn:i(()=>[I("footer",de,[D(p.$slots,"footer",{},()=>[l(y,{onClick:d[0]||(d[0]=u=>s.value=!1)},{default:i(()=>[k("取消")]),_:1}),l(y,{loading:o.loading,"ml-20":"",type:"primary",onClick:d[1]||(d[1]=u=>r("onSave"))},{default:i(()=>[k("保存")]),_:1},8,["loading"])])])]),key:"0"}:void 0]),1032,["show","style","title"])}}},v={getPosts:(o={})=>_.get("posts",{params:o}),getPostById:o=>_.get(`/post/${o}`),addPost:o=>_.post("/post",o),updatePost:o=>_.put(`/post/${o.id}`,o),deletePost:o=>_.delete(`/post/${o}`)},Te=Object.assign({name:"Crud"},{__name:"index",setup(o){const r=b(null),x=b([]),s=b({}),p=b({});Y(()=>{var e;(e=r.value)==null||e.handleSearch()});const d=[{type:"selection",fixed:"left"},{title:"发布",key:"isPublish",width:60,align:"center",fixed:"left",render(e){return f(se,{size:"small",rubberBand:!1,value:e.isPublish,loading:!!e.publishing,onUpdateValue:()=>w(e)})}},{title:"标题",key:"title",width:150,ellipsis:{tooltip:!0}},{title:"分类",key:"category",width:80,ellipsis:{tooltip:!0}},{title:"创建人",key:"author",width:80},{title:"创建时间",key:"createDate",width:150,render(e){return f("span",U(e.createDate))}},{title:"最后更新时间",key:"updateDate",width:150,render(e){return f("span",U(e.updateDate))}},{title:"操作",key:"actions",width:240,align:"center",fixed:"right",hideInExcel:!0,render(e){return[f(c,{size:"small",type:"primary",secondary:!0,onClick:()=>V(e)},{default:()=>"查看",icon:$("majesticons:eye-line",{size:14})}),f(c,{size:"small",type:"primary",style:"margin-left: 15px;",onClick:()=>T(e)},{default:()=>"编辑",icon:$("material-symbols:edit-outline",{size:14})}),f(c,{size:"small",type:"error",style:"margin-left: 15px;",onClick:()=>R(e.id)},{default:()=>"删除",icon:$("material-symbols:delete-outline",{size:14})})]}}];function y(e){e.length&&$message.info(`选中${e.join(" ")}`)}function w(e){ee(e.id)||(e.publishing=!0,setTimeout(()=>{e.isPublish=!e.isPublish,e.publishing=!1,$message==null||$message.success(e.isPublish?"已发布":"已取消发布")},1e3))}const{modalVisible:u,modalAction:z,modalTitle:j,modalLoading:F,handleAdd:O,handleDelete:R,handleEdit:T,handleView:V,handleSave:N,modalForm:m,modalFormRef:A}=ae({name:"文章",initForm:{author:"大脸怪"},doCreate:v.addPost,doDelete:v.deletePost,doUpdate:v.updatePost,refresh:()=>{var e;return(e=r.value)==null?void 0:e.handleSearch()}});return(e,a)=>{const S=le,g=re,E=oe,K=te,C=ne,M=ie,L=ue,Q=G;return q(),B(Q,{"show-footer":"",title:"文章"},{action:i(()=>[I("div",null,[l(t(c),{type:"primary",secondary:"",onClick:a[0]||(a[0]=n=>{var h;return(h=t(r))==null?void 0:h.handleExport()})},{default:i(()=>[l(S,{icon:"mdi:download",size:18,class:"mr-5"}),k(" 导出 ")]),_:1}),l(t(c),{type:"primary",class:"ml-16",onClick:t(O)},{default:i(()=>[l(S,{icon:"material-symbols:add",size:18,class:"mr-5"}),k(" 新建文章 ")]),_:1},8,["onClick"])])]),default:i(()=>[l(K,{ref_key:"$table",ref:r,"query-items":t(s),"onUpdate:queryItems":a[2]||(a[2]=n=>P(s)?s.value=n:null),"extra-params":t(p),"scroll-x":1200,columns:d,"get-data":t(v).getPosts,onOnChecked:y,onOnDataChange:a[3]||(a[3]=n=>x.value=n)},{queryBar:i(()=>[l(E,{label:"标题","label-width":50},{default:i(()=>{var n;return[l(g,{value:t(s).title,"onUpdate:value":a[1]||(a[1]=h=>t(s).title=h),type:"text",placeholder:"请输入标题",onKeypress:Z((n=t(r))==null?void 0:n.handleSearch,["enter"])},null,8,["value","onKeypress"])]}),_:1})]),_:1},8,["query-items","extra-params","get-data"]),l(L,{visible:t(u),"onUpdate:visible":a[7]||(a[7]=n=>P(u)?u.value=n:null),title:t(j),loading:t(F),"show-footer":t(z)!=="view",onOnSave:t(N)},{default:i(()=>[l(M,{ref_key:"modalFormRef",ref:A,"label-placement":"left","label-align":"left","label-width":80,model:t(m),disabled:t(z)==="view"},{default:i(()=>[l(C,{label:"作者",path:"author"},{default:i(()=>[l(g,{value:t(m).author,"onUpdate:value":a[4]||(a[4]=n=>t(m).author=n),disabled:""},null,8,["value"])]),_:1}),l(C,{label:"文章标题",path:"title",rule:{required:!0,message:"请输入文章标题",trigger:["input","blur"]}},{default:i(()=>[l(g,{value:t(m).title,"onUpdate:value":a[5]||(a[5]=n=>t(m).title=n),placeholder:"请输入文章标题"},null,8,["value"])]),_:1}),l(C,{label:"文章内容",path:"content",rule:{required:!0,message:"请输入文章内容",trigger:["input","blur"]}},{default:i(()=>[l(g,{value:t(m).content,"onUpdate:value":a[6]||(a[6]=n=>t(m).content=n),placeholder:"请输入文章内容",type:"textarea",autosize:{minRows:3,maxRows:5}},null,8,["value"])]),_:1})]),_:1},8,["model","disabled"])]),_:1},8,["visible","title","loading","show-footer","onOnSave"])]),_:1})}}});export{Te as default};
