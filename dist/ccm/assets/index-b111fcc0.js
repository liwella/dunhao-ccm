import{_ as G}from"./CommonPage-df3cba64.js";import{e as H,o as q,j as B,aj as J,w as i,n as I,ak as D,k as o,m as k,l as t,D as P,x as W,_ as c,al as X,am as _,q as b,ah as Y,z as Z,h as f,an as ee}from"./index-5837b170.js";import{_ as te}from"./CrudTable-2986cf73.js";import{_ as le}from"./QueryBarItem-fca409cf.js";import{_ as oe}from"./TheIcon-2507ec8e.js";import{f as U}from"./common-3dc8d806.js";import{r as $}from"./icon-17ab6bf1.js";import{u as ae,_ as ne,a as ie}from"./useCRUD-f6f94421.js";import{_ as se}from"./Switch-7fee4a01.js";import{_ as re}from"./Input-de71e776.js";import"./AppPage-87197e9c.js";import"./_plugin-vue_export-helper-c27b6911.js";import"./use-merged-state-61c7490e.js";import"./Space-fc43479b.js";import"./Checkbox-df9fc212.js";import"./Popover-09c0b6af.js";import"./get-803e7bb1.js";import"./use-compitable-8b432e4c.js";import"./Suffix-562a013d.js";import"./Dropdown-5a734c78.js";import"./create-d1a5db2f.js";import"./Tooltip-aaf5ff4a.js";import"./Empty-8e6e6efa.js";import"./use-locale-4062cbc7.js";import"./Select-a522e322.js";import"./Tag-cc294052.js";import"./Eye-0db273d2.js";const de={flex:"","justify-end":""},ue={__name:"CrudModal",props:{width:{type:String,default:"600px"},title:{type:String,default:""},showFooter:{type:Boolean,default:!0},visible:{type:Boolean,required:!0},loading:{type:Boolean,default:!1}},emits:["onSave","modalInvisible"],setup(l,{emit:r}){const x=l,s=H({get(){return x.visible},set(p){r("modalInvisible",p)}});return(p,d)=>{const y=c,w=X;return q(),B(w,{show:t(s),"onUpdate:show":d[2]||(d[2]=u=>P(s)?s.value=u:null),style:W({width:l.width}),preset:"card",title:l.title,size:"huge",bordered:!1},J({default:i(()=>[D(p.$slots,"default")]),_:2},[l.showFooter?{name:"footer",fn:i(()=>[I("footer",de,[D(p.$slots,"footer",{},()=>[o(y,{onClick:d[0]||(d[0]=u=>s.value=!1)},{default:i(()=>[k("取消")]),_:1}),o(y,{loading:l.loading,"ml-20":"",type:"primary",onClick:d[1]||(d[1]=u=>r("onSave"))},{default:i(()=>[k("保存")]),_:1},8,["loading"])])])]),key:"0"}:void 0]),1032,["show","style","title"])}}},v={getPosts:(l={})=>_.get("posts",{params:l}),getPostById:l=>_.get(`/post/${l}`),addPost:l=>_.post("/post",l),updatePost:l=>_.put(`/post/${l.id}`,l),deletePost:l=>_.delete(`/post/${l}`)},Te=Object.assign({name:"Crud"},{__name:"index",setup(l){const r=b(null),x=b([]),s=b({}),p=b({});Y(()=>{var e;(e=r.value)==null||e.handleSearch()});const d=[{type:"selection",fixed:"left"},{title:"发布",key:"isPublish",width:60,align:"center",fixed:"left",render(e){return f(se,{size:"small",rubberBand:!1,value:e.isPublish,loading:!!e.publishing,onUpdateValue:()=>w(e)})}},{title:"标题",key:"title",width:150,ellipsis:{tooltip:!0}},{title:"分类",key:"category",width:80,ellipsis:{tooltip:!0}},{title:"创建人",key:"author",width:80},{title:"创建时间",key:"createDate",width:150,render(e){return f("span",U(e.createDate))}},{title:"最后更新时间",key:"updateDate",width:150,render(e){return f("span",U(e.updateDate))}},{title:"操作",key:"actions",width:240,align:"center",fixed:"right",hideInExcel:!0,render(e){return[f(c,{size:"small",type:"primary",secondary:!0,onClick:()=>V(e)},{default:()=>"查看",icon:$("majesticons:eye-line",{size:14})}),f(c,{size:"small",type:"primary",style:"margin-left: 15px;",onClick:()=>T(e)},{default:()=>"编辑",icon:$("material-symbols:edit-outline",{size:14})}),f(c,{size:"small",type:"error",style:"margin-left: 15px;",onClick:()=>R(e.id)},{default:()=>"删除",icon:$("material-symbols:delete-outline",{size:14})})]}}];function y(e){e.length&&$message.info(`选中${e.join(" ")}`)}function w(e){ee(e.id)||(e.publishing=!0,setTimeout(()=>{e.isPublish=!e.isPublish,e.publishing=!1,$message==null||$message.success(e.isPublish?"已发布":"已取消发布")},1e3))}const{modalVisible:u,modalAction:z,modalTitle:j,modalLoading:F,handleAdd:O,handleDelete:R,handleEdit:T,handleView:V,handleSave:N,modalForm:m,modalFormRef:A}=ae({name:"文章",initForm:{author:"大脸怪"},doCreate:v.addPost,doDelete:v.deletePost,doUpdate:v.updatePost,refresh:()=>{var e;return(e=r.value)==null?void 0:e.handleSearch()}});return(e,a)=>{const S=oe,h=re,E=le,K=te,C=ne,M=ie,L=ue,Q=G;return q(),B(Q,{"show-footer":"",title:"文章"},{action:i(()=>[I("div",null,[o(t(c),{type:"primary",secondary:"",onClick:a[0]||(a[0]=n=>{var g;return(g=t(r))==null?void 0:g.handleExport()})},{default:i(()=>[o(S,{icon:"mdi:download",size:18,class:"mr-5"}),k(" 导出 ")]),_:1}),o(t(c),{type:"primary",class:"ml-16",onClick:t(O)},{default:i(()=>[o(S,{icon:"material-symbols:add",size:18,class:"mr-5"}),k(" 新建文章 ")]),_:1},8,["onClick"])])]),default:i(()=>[o(K,{ref_key:"$table",ref:r,"query-items":t(s),"onUpdate:queryItems":a[2]||(a[2]=n=>P(s)?s.value=n:null),"extra-params":t(p),"scroll-x":1200,columns:d,"get-data":t(v).getPosts,onOnChecked:y,onOnDataChange:a[3]||(a[3]=n=>x.value=n)},{queryBar:i(()=>[o(E,{label:"标题","label-width":50},{default:i(()=>{var n;return[o(h,{value:t(s).title,"onUpdate:value":a[1]||(a[1]=g=>t(s).title=g),type:"text",placeholder:"请输入标题",onKeypress:Z((n=t(r))==null?void 0:n.handleSearch,["enter"])},null,8,["value","onKeypress"])]}),_:1})]),_:1},8,["query-items","extra-params","get-data"]),o(L,{visible:t(u),"onUpdate:visible":a[7]||(a[7]=n=>P(u)?u.value=n:null),title:t(j),loading:t(F),"show-footer":t(z)!=="view",onOnSave:t(N)},{default:i(()=>[o(M,{ref_key:"modalFormRef",ref:A,"label-placement":"left","label-align":"left","label-width":80,model:t(m),disabled:t(z)==="view"},{default:i(()=>[o(C,{label:"作者",path:"author"},{default:i(()=>[o(h,{value:t(m).author,"onUpdate:value":a[4]||(a[4]=n=>t(m).author=n),disabled:""},null,8,["value"])]),_:1}),o(C,{label:"文章标题",path:"title",rule:{required:!0,message:"请输入文章标题",trigger:["input","blur"]}},{default:i(()=>[o(h,{value:t(m).title,"onUpdate:value":a[5]||(a[5]=n=>t(m).title=n),placeholder:"请输入文章标题"},null,8,["value"])]),_:1}),o(C,{label:"文章内容",path:"content",rule:{required:!0,message:"请输入文章内容",trigger:["input","blur"]}},{default:i(()=>[o(h,{value:t(m).content,"onUpdate:value":a[6]||(a[6]=n=>t(m).content=n),placeholder:"请输入文章内容",type:"textarea",autosize:{minRows:3,maxRows:5}},null,8,["value"])]),_:1})]),_:1},8,["model","disabled"])]),_:1},8,["visible","title","loading","show-footer","onOnSave"])]),_:1})}}});export{Te as default};
