var z=(r,m,i)=>new Promise((g,u)=>{var k=l=>{try{c(i.next(l))}catch(_){u(_)}},x=l=>{try{c(i.throw(l))}catch(_){u(_)}},c=l=>l.done?g(l.value):Promise.resolve(l.value).then(k,x);c((i=i.apply(r,m)).next())});import{_ as H}from"./AppPage-d038b9ad.js";import{_ as I}from"./CrudDrawer-343eb8ff.js";import{s as v,C as L,q as D,h as C,_ as p,o as M,j as O,w as a,k as n,l as e,m as U,D as S,G as P}from"./index-a05ebb11.js";import{u as J,_ as Q,a as W}from"./useCRUD-3b029c3f.js";import{r as b}from"./icon-ff0c09b3.js";import{_ as X}from"./Spin-1c5bc334.js";import{_ as Y}from"./Tree-62a1861c.js";import{_ as Z}from"./Space-5f0be7ca.js";import{_ as ee}from"./Input-aa8ec768.js";import"./_plugin-vue_export-helper-c27b6911.js";import"./use-merged-state-ff5e0511.js";import"./get-f8141a7b.js";import"./use-compitable-cbdc2722.js";import"./Checkbox-c0ec2f7e.js";import"./create-d1a5db2f.js";import"./Empty-12035f64.js";import"./use-locale-cb2f3061.js";import"./Suffix-b467bef6.js";import"./Eye-c02532aa.js";const h={listCategory:()=>v.post("/category/listCategory"),addCategory:(r={})=>v.post("/category/addCategory",r),updateCategory:(r={})=>v.post("/category/updateCategory",r),moveCategory:(r={})=>v.post("/category/moveCategory",r),deleteCategory:(r={})=>v.post("/category/deleteCategory",r)},he={__name:"index",setup(r){L(()=>{u()});const m=D([]),i=D([]),g=D(!1);function u(){return z(this,null,function*(){g.value=!0;const f=yield h.listCategory(),t=k(f.data);i.value=t,g.value=!1})}function k(f=[]){const t=[];return f.forEach(o=>{const w=[C(p,{size:"small",type:"primary",text:!0,style:"margin-left: 15px;",onClick:()=>{B({parent:o.id,name:o.name},!1)}},{default:()=>"",icon:b("material-symbols:edit-outline",{size:20})}),C(p,{size:"small",type:"error",text:!0,style:"margin-left: 15px;",onClick:()=>{$({id:o.id})}},{default:()=>"",icon:b("material-symbols:delete-outline",{size:20})}),C(p,{size:"small",type:"primary",text:!0,style:"margin-left: 15px;",onClick:()=>{c({id:o.id,up:!0})}},{default:()=>"",icon:b("material-symbols:arrow-upward",{size:20})}),C(p,{size:"small",type:"primary",text:!0,onClick:()=>{c({id:o.id,up:!1})}},{default:()=>"",icon:b("material-symbols:arrow-downward",{size:20})})],y={label:o.name,key:o.id,children:[]};o.level===0?y.suffix=()=>[C(p,{size:"small",type:"primary",text:!0,onClick:()=>{R({parent:o.id})}},{default:()=>"",icon:b("material-symbols:add-notes-outline-rounded",{size:22})}),...w]:y.suffix=()=>w,o.children&&o.children.length&&(y.children=k(o.children)),t.push(y)}),t}function x(){d.value.id=d.value.parent,E()}function c(){return z(this,arguments,function*(f={}){yield h.moveCategory(f),u()})}const{modalVisible:l,modalAction:_,modalTitle:V,modalLoading:q,handleAdd:R,handleDelete:$,handleEdit:B,handleSave:E,modalForm:d,modalFormRef:K}=J({name:"分类",initForm:{},doCreate:h.addCategory,doDelete:h.deleteCategory,doUpdate:h.updateCategory,refresh:()=>u()});return(f,t)=>{const o=Y,w=X,y=Z,F=ee,A=Q,N=W,T=I,j=P,G=H;return M(),O(G,{"show-footer":!1},{default:a(()=>[n(j,{title:"分类管理",size:"small",segmented:!0,"mt-15":"","rounded-10":""},{"header-extra":a(()=>[n(e(p),{type:"primary",onClick:e(R)},{default:a(()=>[U("新增主分类")]),_:1},8,["onClick"]),n(e(p),{type:"error","ml-20":"",onClick:t[0]||(t[0]=s=>e($)({ids:e(m)}))},{default:a(()=>[U("删除")]),_:1})]),default:a(()=>[n(y,{vertical:""},{default:a(()=>[n(w,{show:e(g)},{description:a(()=>[U("加载中 ~")]),default:a(()=>[n(o,{"checked-keys":e(m),"onUpdate:checkedKeys":t[1]||(t[1]=s=>S(m)?m.value=s:null),data:e(i),checkable:"",selectable:"","block-line":"",cascade:""},null,8,["checked-keys","data"])]),_:1},8,["show"])]),_:1}),n(T,{visible:e(l),"onUpdate:visible":t[4]||(t[4]=s=>S(l)?l.value=s:null),title:e(V),loading:e(q),"show-footer":e(_)!=="view",onOnSave:x},{default:a(()=>[n(N,{ref_key:"modalFormRef",ref:K,model:e(d),"label-placement":"left","label-align":"left","label-width":80,disabled:e(_)==="view"},{default:a(()=>[n(A,{label:"父分类id",path:"parent"},{default:a(()=>[n(F,{value:e(d).parent,"onUpdate:value":t[2]||(t[2]=s=>e(d).parent=s),disabled:""},null,8,["value"])]),_:1}),n(A,{label:"分类名称"},{default:a(()=>[n(F,{value:e(d).name,"onUpdate:value":t[3]||(t[3]=s=>e(d).name=s),placeholder:"请输入分类名称"},null,8,["value"])]),_:1})]),_:1},8,["model","disabled"])]),_:1},8,["visible","title","loading","show-footer"])]),_:1})]),_:1})}}};export{he as default};
